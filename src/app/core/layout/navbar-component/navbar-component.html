<button
  class="mnv-toggle"
  type="button"
  aria-label="Toggle menu"
  (click)="toggleDrawer()"
>
  <span [class.open]="drawerOpen"></span>
</button>

<nav 
  class="rail mnv-navbar" 
  [class.navbar--scrolled]="isScrolled" 
  role="navigation" 
  aria-label="Main"
>
  <div class="rail__header" routerLink="/">
    <div class="brand">
      <img
        src="../../../../assets/img/left_horz.svg"
        alt="Monova logo"
        class="navbar-logo"
        (click)="closeDrawer()"
      />
    </div>
  </div>

  <!-- MAIN NAV LINKS (desktop) -->
  <ul class="rail__nav">
    @for (item of menu; track item.label) {
      <li class="nav-item">
        <a
          class="nav-link"
          [routerLink]="item.link"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
          (click)="closeDrawer()"
        >
          <span class="label">{{ item.label | translate }}</span>
        </a>
      </li>
    }
  </ul>

  <!-- RIGHT SIDE: AUTH + LANG DROPDOWN -->
  <div class="rail__bottom">
    <div class="profile">
      @if (auth.isLoggedIn()) {
        <div class="profile">
          <a routerLink="/profile" class="profile__pill">
            <div class="profile__avatar">
              {{
                (auth.currentUser()?.name ||
                  auth.currentUser()?.email ||
                  'U'
                ).charAt(0)
              }}
            </div>
            <div class="profile__text">
              <div class="profile__name">
                {{ auth.currentUser()?.name || auth.currentUser()?.email }}
              </div>
              <div class="profile__sub">View profile</div>
            </div>
          </a>

          <button
            type="button"
            class="btn btn--primary btn--sm"
            (click)="onLogout()"
          >
            {{ 'NAV.LOGOUT' | translate }}
          </button>
        </div>
      } @else {
        <div class="login-buttons">
          <a
            class="btn btn--primary btn--sm"
            routerLink="/auth/login"
          >
            {{ 'NAV.SIGN_IN' | translate }}
          </a>
          <a
            class="btn btn--outline btn--sm"
            routerLink="/auth/register"
          >
            {{ 'NAV.SIGN_UP' | translate }}
          </a>
        </div>
      }
    </div>

    <!-- LANGUAGE DROPDOWN (icon only) -->
    <div class="lang-dropdown">
      <button
        type="button"
        class="lang-trigger"
        aria-label="Change language"
        [attr.aria-expanded]="langMenuOpen"
        (click)="toggleLangMenu()"
      >
        <span class="fi" [ngClass]="'fi-' + activeLangDef.flag"></span>
      </button>

      @if (langMenuOpen) {
        <ul class="lang-menu" role="menu">
          @for (l of langs; track l.code) {
            <li>
              <button
                type="button"
                class="lang-option"
                role="menuitem"
                [class.active]="activeLang === l.code"
                (click)="setLang(l.code)"
              >
                <span class="fi" [ngClass]="'fi-' + l.flag"></span>
              </button>
            </li>
          }
        </ul>
      }
    </div>
  </div>

  <!-- MOBILE DRAWER -->
@if (drawerOpen) {
  <div class="drawer" (click)="closeDrawer()">
    <aside class="drawer__panel" (click)="$event.stopPropagation()">

      <div class="brand brand--drawer">
        <div class="brand__name">MONOVA</div>
        <div class="brand__tag">Recruitment</div>
      </div>

      <ul class="drawer__nav">
        @for (item of menu; track item.label) {
          <li>
            <a
              [routerLink]="item.link"
              (click)="closeDrawer()"
            >
              {{ item.label | translate }}
            </a>
          </li>
        }
      </ul>

      <!-- AUTH BLOCK INSIDE DRAWER -->
      <div class="drawer__auth">
        @if (auth.isLoggedIn()) {
          <div class="profile profile--drawer">
            <a routerLink="/profile" class="profile__pill" (click)="closeDrawer()">
              <div class="profile__avatar">
                {{
                  (auth.currentUser()?.name ||
                    auth.currentUser()?.email ||
                    'U'
                  ).charAt(0)
                }}
              </div>
              <div class="profile__text">
                <div class="profile__name">
                  {{ auth.currentUser()?.name || auth.currentUser()?.email }}
                </div>
                <div class="profile__sub">View profile</div>
              </div>
            </a>

            <button
              type="button"
              class="btn btn--primary btn--sm drawer__logout"
              (click)="onLogout(); closeDrawer()"
            >
              {{ 'NAV.LOGOUT' | translate }}
            </button>
          </div>
        } @else {
          <div class="login-buttons login-buttons--drawer">
            <a
              class="btn btn--primary btn--sm"
              routerLink="/auth/login"
              (click)="closeDrawer()"
            >
              {{ 'NAV.SIGN_IN' | translate }}
            </a>
            <a
              class="btn btn--outline btn--sm"
              routerLink="/auth/register"
              (click)="closeDrawer()"
            >
              {{ 'NAV.SIGN_UP' | translate }}
            </a>
          </div>
        }
      </div>

      <!-- LANGUAGES -->
      <div class="drawer__langs">
        @for (l of langs; track l.code) {
          <button
            type="button"
            [class.active]="activeLang === l.code"
            (click)="setLang(l.code)"
          >
            <span class="fi" [ngClass]="'fi-' + l.flag"></span>
          </button>
        }
      </div>

    </aside>
  </div>
}

</nav>
